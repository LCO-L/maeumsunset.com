<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SunSet - AI ê°ì • ë™ë°˜ì</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .phone-container {
            width: 400px;
            height: 700px;
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            border-radius: 30px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            position: relative;
            overflow: hidden;
        }

        /* Dock ìœ ë„ ì˜¤ë²„ë ˆì´ */
        .dock-prompt-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        .dock-prompt-content {
            background: linear-gradient(145deg, #ff6b35, #f7931e);
            padding: 30px;
            border-radius: 25px;
            text-align: center;
            color: white;
            max-width: 300px;
            animation: dockPulse 2s ease-in-out infinite;
        }

        @keyframes dockPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(255,107,53,0.5); }
            50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(255,107,53,0.8); }
        }

        .dock-prompt-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .dock-prompt-text {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .dock-prompt-buttons {
            display: flex;
            gap: 10px;
        }

        .dock-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dock-btn-yes {
            background: white;
            color: #ff6b35;
        }

        .dock-btn-later {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* í—¤ë” */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            color: white;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            animation: logoBreath 3s ease-in-out infinite;
        }

        @keyframes logoBreath {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .user-stats {
            font-size: 12px;
            opacity: 0.8;
            text-align: right;
        }

        .streak-counter {
            color: #ff6b35;
            font-weight: 700;
        }

        /* ë©”ì¸ ë·° */
        .main-view {
            display: none;
            height: calc(100% - 80px);
        }

        .main-view.active {
            display: block;
        }

        /* í™ˆ í™”ë©´ */
        .home-container {
            color: white;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* AI ë™ë°˜ì ìƒíƒœ */
        .ai-companion {
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: 15px;
            padding: 12px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: aiGlow 4s ease-in-out infinite;
        }

        @keyframes aiGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(255,107,53,0.2); }
            50% { box-shadow: 0 0 20px rgba(255,107,53,0.4); }
        }

        .ai-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            animation: avatarPulse 2s ease-in-out infinite;
        }

        @keyframes avatarPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .ai-message {
            flex: 1;
            font-size: 13px;
            line-height: 1.3;
        }

        .ai-name {
            color: #ff6b35;
            font-weight: 600;
            margin-bottom: 2px;
        }

        /* ì–´ì œ ê¸°ë¡ + ì—°ì† ìŠ¤íŠ¸ë¦­ */
        .yesterday-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .yesterday-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .yesterday-label {
            font-size: 12px;
            opacity: 0.7;
        }

        .streak-badge {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            animation: streakGlow 3s ease-in-out infinite;
        }

        @keyframes streakGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(255,107,53,0.3); }
            50% { box-shadow: 0 0 15px rgba(255,107,53,0.6); }
        }

        .yesterday-text {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .emotion-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .emotion-tag {
            background: rgba(255, 107, 53, 0.2);
            color: #ff6b35;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            border: 1px solid rgba(255, 107, 53, 0.3);
            animation: tagFloat 6s ease-in-out infinite;
        }

        @keyframes tagFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }

        /* ë©”ì¸ ì…ë ¥ ì˜ì—­ */
        .main-input-area {
            flex: 1;
            position: relative;
        }

        .main-textarea {
            width: 100%;
            height: 180px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 20px;
            color: white;
            font-size: 16px;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
            font-family: inherit;
            line-height: 1.5;
        }

        .main-textarea:focus {
            border-color: #ff6b35;
            background: rgba(255, 107, 53, 0.1);
            box-shadow: 0 0 30px rgba(255, 107, 53, 0.3);
        }

        .main-textarea::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        /* ì‹¤ì‹œê°„ ê°ì • ì˜¤ë¼ */
        .emotion-aura {
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 25px;
            pointer-events: none;
            opacity: 0;
            transition: all 0.5s ease;
        }

        .emotion-aura.happy {
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, transparent 70%);
            animation: happyPulse 2s ease-in-out infinite;
        }

        .emotion-aura.sad {
            background: radial-gradient(circle, rgba(100,149,237,0.3) 0%, transparent 70%);
            animation: sadFlow 3s ease-in-out infinite;
        }

        .emotion-aura.angry {
            background: radial-gradient(circle, rgba(255,69,0,0.4) 0%, transparent 70%);
            animation: angryFlicker 1s ease-in-out infinite;
        }

        .emotion-aura.calm {
            background: radial-gradient(circle, rgba(144,238,144,0.3) 0%, transparent 70%);
            animation: calmBreath 4s ease-in-out infinite;
        }

        @keyframes happyPulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.02); }
        }

        @keyframes sadFlow {
            0%, 100% { opacity: 0.2; transform: translateY(0); }
            50% { opacity: 0.4; transform: translateY(-5px); }
        }

        @keyframes angryFlicker {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }

        @keyframes calmBreath {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            50% { opacity: 0.4; transform: scale(1.01); }
        }

        /* ê¸¸ì´ + ê°ì • í‘œì‹œê¸° */
        .emotion-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(#ff6b35 0deg, rgba(255, 255, 255, 0.1) 0deg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .emotion-emoji {
            font-size: 20px;
            margin-bottom: 2px;
        }

        .length-number {
            font-size: 9px;
            opacity: 0.8;
        }

        /* AI í”„ë¡œë¸Œ ì‹œìŠ¤í…œ */
        .ai-probe-system {
            margin-top: 15px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .ai-probe-system.show {
            opacity: 1;
            transform: translateY(0);
        }

        .ai-probe-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .ai-probe-avatar {
            width: 24px;
            height: 24px;
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .ai-probe-question {
            background: rgba(255, 107, 53, 0.15);
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: 15px;
            padding: 12px;
            color: #ff6b35;
            font-size: 14px;
            border-left: 4px solid #ff6b35;
            animation: questionGlow 3s ease-in-out infinite;
        }

        @keyframes questionGlow {
            0%, 100% { background: rgba(255, 107, 53, 0.15); }
            50% { background: rgba(255, 107, 53, 0.25); }
        }

        .ai-probe-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px;
            color: white;
            font-size: 14px;
            resize: none;
            min-height: 60px;
            outline: none;
            transition: all 0.3s ease;
            margin-top: 8px;
        }

        .ai-probe-input:focus {
            border-color: #ff6b35;
            box-shadow: 0 0 15px rgba(255, 107, 53, 0.2);
        }

        /* ì‚¬ìš© í˜„í™© */
        .usage-stats {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 12px;
            margin-top: 15px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .stat-value {
            color: #ff6b35;
            font-weight: 600;
        }

        /* Dock ìœ ë„ ë²„íŠ¼ */
        .dock-hint {
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: 12px;
            padding: 10px;
            margin-top: 10px;
            text-align: center;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: dockBlink 4s ease-in-out infinite;
        }

        @keyframes dockBlink {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .dock-hint:hover {
            background: rgba(255, 107, 53, 0.2);
            transform: translateY(-2px);
        }

        /* ì•¡ì…˜ ë²„íŠ¼ë“¤ */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            border: none;
            padding: 14px 20px;
            border-radius: 25px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            font-size: 16px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 53, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        /* ìº í”„íŒŒì´ì–´ í™”ë©´ */
        .campfire-container {
            color: white;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .campfire-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #ff6b35;
        }

        .fire-container {
            position: relative;
            margin: 20px auto;
            width: 180px;
            height: 180px;
        }

        .fire {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 100px;
            background: radial-gradient(circle, #ff6b35 0%, #ff8c42 30%, #ffd662 70%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: fireFlicker 2s ease-in-out infinite alternate;
        }

        .fire.happy {
            background: radial-gradient(circle, #ffd700 0%, #ff8c42 30%, #ffff88 70%);
            animation: fireFlickerHappy 1.5s ease-in-out infinite alternate;
        }

        .fire.sad {
            background: radial-gradient(circle, #6495ed 0%, #4169e1 30%, #87ceeb 70%);
            animation: fireFlickerSad 3s ease-in-out infinite alternate;
        }

        .fire.angry {
            background: radial-gradient(circle, #ff4500 0%, #dc143c 30%, #ff6347 70%);
            animation: fireFlickerAngry 1s ease-in-out infinite alternate;
        }

        @keyframes fireFlicker {
            0% { transform: translateX(-50%) scale(1) rotate(-1deg); }
            100% { transform: translateX(-50%) scale(1.05) rotate(1deg); }
        }

        @keyframes fireFlickerHappy {
            0% { transform: translateX(-50%) scale(1) rotate(-2deg); filter: brightness(1.3); }
            100% { transform: translateX(-50%) scale(1.15) rotate(2deg); filter: brightness(1.5); }
        }

        @keyframes fireFlickerSad {
            0% { transform: translateX(-50%) scale(0.9) rotate(-0.5deg); filter: brightness(0.8); }
            100% { transform: translateX(-50%) scale(0.95) rotate(0.5deg); filter: brightness(0.9); }
        }

        @keyframes fireFlickerAngry {
            0% { transform: translateX(-50%) scale(1.1) rotate(-3deg); filter: brightness(1.4); }
            100% { transform: translateX(-50%) scale(1.2) rotate(3deg); filter: brightness(1.6); }
        }

        .logs {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 25px;
            background: #8B4513;
            border-radius: 12px;
        }

        .logs::before, .logs::after {
            content: '';
            position: absolute;
            width: 80px;
            height: 20px;
            background: #A0522D;
            border-radius: 10px;
        }

        .logs::before {
            top: -8px;
            left: 10px;
            transform: rotate(-12deg);
        }

        .logs::after {
            top: -8px;
            right: 10px;
            transform: rotate(12deg);
        }

        /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        .bottom-nav {
            position: absolute;
            bottom: 15px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 12px;
        }

        .nav-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 12px;
            position: relative;
        }

        .nav-btn.active {
            color: #ff6b35;
            background: rgba(255, 107, 53, 0.2);
            transform: scale(1.1);
        }

        .nav-btn .notification-dot {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            background: #ff6b35;
            border-radius: 50%;
            animation: notificationPulse 2s ease-in-out infinite;
        }

        @keyframes notificationPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.3); }
        }

        /* í† ìŠ¤íŠ¸ ì‹œìŠ¤í…œ */
        .toast {
            position: fixed;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 107, 53, 0.95);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 14px;
            z-index: 2000;
            backdrop-filter: blur(10px);
            animation: toastSlide 0.3s ease-out;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.4);
        }

        @keyframes toastSlide {
            0% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            100% { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        /* ìœ„ì ¯ ì‹œë®¬ë ˆì´ì…˜ */
        .widget-preview {
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            font-size: 12px;
        }

        .widget-title {
            color: #ff6b35;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .widget-content {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.3;
        }
    </style>
</head>
<body>
    <div class="phone-container">
        <!-- Dock ìœ ë„ ì˜¤ë²„ë ˆì´ -->
        <div class="dock-prompt-overlay" id="dockPromptOverlay">
            <div class="dock-prompt-content">
                <div class="dock-prompt-title">ğŸ”¥ ë” ë¹ ë¥´ê²Œ ì—´ì–´ë³´ì„¸ìš”!</div>
                <div class="dock-prompt-text">
                    SunSetì„ Dockì— ì¶”ê°€í•˜ë©´<br>
                    âœ¨ 3ì´ˆ ì•ˆì— ë°”ë¡œ ê¸°ë¡ ì‹œì‘<br>
                    ğŸ ë§¤ì¼ íŠ¹ë³„ ë³´ë„ˆìŠ¤ ë¶ˆê½ƒ<br>
                    ğŸ”® AIê°€ ë” ê¹Šì´ ì´í•´í•´ìš”
                </div>
                <div class="dock-prompt-buttons">
                    <button class="dock-btn dock-btn-yes" onclick="addToDock()">Dock ì¶”ê°€!</button>
                    <button class="dock-btn dock-btn-later" onclick="closeDockPrompt()">ë‚˜ì¤‘ì—</button>
                </div>
            </div>
        </div>

        <div class="header">
            <div class="logo">
                <div class="logo-icon">ğŸŒ…</div>
                <span style="font-weight: 700; font-size: 18px;">SunSet</span>
            </div>
            <div class="user-stats">
                <div class="streak-counter" id="streakCounter">0ì¼ ì—°ì†</div>
                <div id="currentTime"></div>
            </div>
        </div>

        <!-- í™ˆ í™”ë©´ -->
        <div class="main-view active" id="homeView">
            <div class="home-container">
                <!-- AI ë™ë°˜ì ìƒíƒœ -->
                <div class="ai-companion">
                    <div class="ai-avatar">ğŸ¤–</div>
                    <div class="ai-message">
                        <div class="ai-name">Luna AI</div>
                        <div id="aiMessage">ì˜¤ëŠ˜ë„ í•¨ê»˜ ë§ˆìŒì„ ê¸°ë¡í•´ë´ìš”! ğŸ’«</div>
                    </div>
                </div>

                <!-- ì–´ì œ ê¸°ë¡ + ìŠ¤íŠ¸ë¦­ -->
                <div class="yesterday-section">
                    <div class="yesterday-header">
                        <div class="yesterday-label">Yesterday</div>
                        <div class="streak-badge" id="streakBadge">ğŸ”¥ 1ì¼ì°¨</div>
                    </div>
                    <div class="yesterday-text">Feeling motivated and hopeful about the future</div>
                    <div class="emotion-tags">
                        <span class="emotion-tag">í¬ë§ì </span>
                        <span class="emotion-tag">ë™ê¸°ë¶€ì—¬</span>
                        <span class="emotion-tag">í‰ì˜¨</span>
                    </div>
                </div>

                <!-- ë©”ì¸ ì…ë ¥ ì˜ì—­ -->
                <div class="main-input-area">
                    <div class="emotion-aura" id="emotionAura"></div>
                    <textarea 
                        class="main-textarea" 
                        id="mainTextarea"
                        placeholder="ì§€ê¸ˆ ë§ˆìŒì€ ì–´ë–¤ê°€ìš”? Lunaê°€ í•¨ê»˜ ë“¤ì–´ì¤„ê²Œìš”..."
                        autofocus>
                    </textarea>
                    <div class="emotion-indicator" id="emotionIndicator">
                        <div class="emotion-emoji" id="emotionEmoji">ğŸŒ±</div>
                        <div class="length-number" id="lengthNumber">0</div>
                    </div>
                </div>

                <!-- AI í”„ë¡œë¸Œ ì‹œìŠ¤í…œ -->
                <div class="ai-probe-system" id="aiProbeSystem">
                    <div class="ai-probe-header">
                        <div class="ai-probe-avatar">ğŸ¤–</div>
                        <span style="font-size: 12px; color: #ff6b35;">Lunaê°€ ê¶ê¸ˆí•´í•´ìš”</span>
                    </div>
                    <div class="ai-probe-question" id="aiProbeQuestion"></div>
                    <textarea class="ai-probe-input" id="aiProbeInput" placeholder="ë” ìì„¸íˆ ë“¤ë ¤ì£¼ì„¸ìš”..."></textarea>
                </div>

                <!-- ì‚¬ìš© í˜„í™© -->
                <div class="usage-stats">
                    <div class="stat-row">
                        <span>ì—°ì† ê¸°ë¡ì¼</span>
                        <span class="stat-value" id="totalDays">1ì¼</span>
                    </div>
                    <div class="stat-row">
                        <span>ì´ ì‘ì„± ê¸€ì</span>
                        <span class="stat-value" id="totalChars">0ì</span>
                    </div>
                    <div class="stat-row">
                        <span>ìº í”„íŒŒì´ì–´ ì…ì¥</span>
                        <span class="stat-value" id="campfireStatus">2íšŒ ë” í•„ìš”</span>
                    </div>
                </div>

                <!-- Dock ìœ ë„ -->
                <div class="dock-hint" onclick="showDockPrompt()">
                    ğŸ“± Dockì— ì¶”ê°€í•˜ë©´ Lunaê°€ ë” ìì£¼ ë§Œë‚  ìˆ˜ ìˆì–´ìš”!
                </div>

                <!-- ìœ„ì ¯ ì‹œë®¬ë ˆì´ì…˜ -->
                <div class="widget-preview">
                    <div class="widget-title">í™ˆ í™”ë©´ ìœ„ì ¯ ì˜ˆì‹œ</div>
                    <div class="widget-content">
                        "ì˜¤ëŠ˜ì˜ ê¸°ë¡: 3ì¤„ ì™„ì„± âœ¨<br>
                        Luna: ë”°ëœ»í•œ ë§ˆìŒì´ ëŠê»´ì ¸ìš”"
                    </div>
                </div>

                <!-- ì•¡ì…˜ ë²„íŠ¼ -->
                <div class="action-buttons">
                    <button class="btn" id="saveBtn" onclick="saveEntry()">ì €ì¥í•˜ê¸°</button>
                    <button class="btn btn-secondary" id="campfireBtn" onclick="tryAccessCampfire()" disabled>ìº í”„íŒŒì´ì–´</button>
                </div>
            </div>
        </div>

        <!-- ìº í”„íŒŒì´ì–´ í™”ë©´ -->
        <div class="main-view" id="campfireView">
            <div class="campfire-container">
                <div class="campfire-title">Campfire</div>
                
                <div class="fire-container">
                    <div class="logs"></div>
                    <div class="fire" id="campfireFire"></div>
                </div>

                <div style="font-size: 14px; opacity: 0.8; margin-bottom: 20px;">
                    Add more logs to stoke the fire
                </div>

                <div style="width: 100%; flex: 1;">
                    <textarea 
                        style="width: 100%; height: 120px; background: rgba(255, 255, 255, 0.1); border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 20px; padding: 15px; color: white; font-size: 16px; resize: none; outline: none;"
                        id="campfireTextarea"
                        placeholder="ì •ë§ ê¸¸ê³  ì•„ë¦„ë‹¤ìš´ ì¼ê¸°ë¥¼ ì“°ê³  ìˆë‹¤...">
                    </textarea>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.2);">
                        <div>
                            <button style="background: none; border: none; color: rgba(255, 255, 255, 0.7); font-size: 20px; cursor: pointer; margin-right: 15px;" onclick="addEmoji()">ğŸ˜Š</button>
                            <button style="background: none; border: none; color: rgba(255, 255, 255, 0.7); font-size: 20px; cursor: pointer; margin-right: 15px;">ğŸ¤</button>
                            <button style="background: none; border: none; color: rgba(255, 255, 255, 0.7); font-size: 20px; cursor: pointer;">ğŸ“·</button>
                        </div>
                        <button class="btn" style="padding: 10px 20px; font-size: 14px;" onclick="saveCampfireEntry()">ì¥ì‘ ì¶”ê°€</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="bottom-nav">
            <button class="nav-btn active" id="homeNavBtn" onclick="switchView('home')">
                ğŸ 
                <div class="notification-dot" id="homeNotification" style="display: none;"></div>
            </button>
            <button class="nav-btn" id="campfireNavBtn" onclick="switchView('campfire')">
                ğŸ”¥
                <div class="notification-dot" id="campfireNotification" style="display: none;"></div>
            </button>
            <button class="nav-btn" onclick="showStats()">
                ğŸ“Š
                <div class="notification-dot" id="statsNotification"></div>
            </button>
            <button class="nav-btn" onclick="showSettings()">
                âš™ï¸
            </button>
        </div>
    </div>

    <script>
        // ì „ì—­ ìƒíƒœ
        let state = {
            entryCount: 0,
            currentLength: 0,
            currentEmotion: 'neutral',
            streakDays: 1,
            totalChars: 0,
            lastEntryDate: null,
            dockAdded: false,
            widgetEnabled: false,
            aiProbeActive: false,
            dailyGoalMet: false,
            campfireUnlocked: false,
            notificationPermission: false
        };

        // ê°ì •ë³„ AI ë©”ì‹œì§€
        const aiMessages = {
            neutral: "ì˜¤ëŠ˜ë„ í•¨ê»˜ ë§ˆìŒì„ ê¸°ë¡í•´ë´ìš”! ğŸ’«",
            happy: "ê¸°ë¶„ ì¢‹ì€ ì—ë„ˆì§€ê°€ ëŠê»´ì ¸ìš”! âœ¨ ì´ ìˆœê°„ì„ ë” ìì„¸íˆ ê¸°ë¡í•´ë³´ì„¸ìš”!",
            sad: "ë§ˆìŒì´ ë¬´ê±°ìš°ì‹œêµ°ìš”... ğŸ˜” ì²œì²œíˆ í„¸ì–´ë†“ìœ¼ì„¸ìš”, ì œê°€ ë“¤ì–´ì¤„ê²Œìš”",
            angry: "í™”ê°€ ë§ì´ ë‚˜ì‹  ê²ƒ ê°™ì•„ìš” ğŸ”¥ ë¬´ì—‡ì´ ì´ë ‡ê²Œ ë§Œë“¤ì—ˆëŠ”ì§€ ë“¤ë ¤ì£¼ì„¸ìš”",
            calm: "í‰ì˜¨í•œ ë§ˆìŒì´ ëŠê»´ì ¸ìš” ğŸŒ¸ ì´ëŸ° ìˆœê°„ë“¤ì„ ì†Œì¤‘íˆ ê¸°ë¡í•´ë‘ì„¸ìš”",
            excited: "í¥ë¯¸ì§„ì§„í•œ ì¼ì´ ìˆìœ¼ì‹ ê°€ë´ìš”! ğŸ‰ ìì„¸í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”!"
        };

        // ê°ì •ë³„ í”„ë¡œë¸Œ ì§ˆë¬¸
        const emotionProbes = {
            happy: [
                "ì´ ê¸°ìœ ìˆœê°„ì„ ë” ì˜¤ë˜ ê°„ì§í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?",
                "ëˆ„êµ¬ì™€ ì´ ê¸°ì¨ì„ ë‚˜ëˆ„ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?",
                "ì´ëŸ° ê¸°ë¶„ì´ ë“¤ê²Œ ë§Œë“  íŠ¹ë³„í•œ ìˆœê°„ì´ ìˆë‚˜ìš”?"
            ],
            sad: [
                "í˜ë“  ë§ˆìŒì´ ëŠê»´ì ¸ìš”. ëˆ„êµ°ê°€ ì•ˆì•„ì£¼ë©´ ì¢‹ê² ë‚˜ìš”?",
                "ì´ ê°ì •ì´ ì–¸ì œë¶€í„° ì‹œì‘ë˜ì—ˆëŠ”ì§€ ê¸°ì–µë‚˜ì‹œë‚˜ìš”?",
                "ì§€ê¸ˆ ê°€ì¥ í•„ìš”í•œ ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?"
            ],
            angry: [
                "ì •ë§ ì†ìƒí•˜ì…¨ê² ì–´ìš”. ë¬´ì—‡ì´ ê°€ì¥ í™”ë‚˜ê²Œ í–ˆë‚˜ìš”?",
                "ì´ ìƒí™©ì„ ì–´ë–»ê²Œ í•´ê²°í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?",
                "í™”ê°€ ë‚  ë•Œ ë³´í†µ ì–´ë–»ê²Œ ë‹¬ë˜ì‹œë‚˜ìš”?"
            ],
            calm: [
                "í‰ì˜¨í•œ ë§ˆìŒì´ ì¢‹ë„¤ìš”. ì–´ë–¤ ì¼ì´ ì´ëŸ° ê¸°ë¶„ì„ ë§Œë“¤ì–´ì£¼ì—ˆë‚˜ìš”?",
                "ì´ í‰í™”ë¡œìš´ ìˆœê°„ì—ì„œ ë¬´ì—‡ì„ ëŠë¼ì‹œë‚˜ìš”?",
                "ì´ëŸ° í‰ì˜¨í•¨ì„ ë” ìì£¼ ëŠë¼ë ¤ë©´?"
            ],
            excited: [
                "í¥ë¯¸ì§„ì§„í•˜ë„¤ìš”! ì´ ì„¤ë ˜ì„ ë” ìì„¸íˆ ë“¤ë ¤ì£¼ì„¸ìš”!",
                "ì´ ê¸°ëŒ€ê°ì˜ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
                "ì´ëŸ° ì—ë„ˆì§€ë¥¼ ì–´ë–»ê²Œ í™œìš©í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?"
            ]
        };

        // ê°ì •ë³„ ì´ëª¨ì§€
        const emotionEmojis = {
            neutral: 'ğŸŒ±',
            happy: 'ğŸ˜Š',
            sad: 'ğŸ˜¢',
            angry: 'ğŸ˜¡',
            calm: 'ğŸ˜Œ',
            excited: 'ğŸ¤©'
        };

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            updateTime();
            setInterval(updateTime, 60000);
            loadState();
            updateUI();
            checkDailyGoal();
            scheduleNotifications();
            
            // ë©”ì¸ í…ìŠ¤íŠ¸ì—ì–´ë¦¬ì–´ ì´ë²¤íŠ¸
            const mainTextarea = document.getElementById('mainTextarea');
            mainTextarea.addEventListener('input', handleTyping);
            
            // 5ì´ˆ í›„ Dock ìœ ë„ (ì²˜ìŒ ì‚¬ìš©ìë§Œ)
            if (!state.dockAdded) {
                setTimeout(showDockPrompt, 5000);
            }
        });

        // ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = 
                now.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });
        }

        // ì‹¤ì‹œê°„ íƒ€ì´í•‘ ì²˜ë¦¬
        function handleTyping() {
            const text = this.value;
            const length = text.length;
            state.currentLength = length;

            // ì‹¤ì‹œê°„ ê°ì • ë¶„ì„ (ì‹œë®¬ë ˆì´ì…˜)
            const emotion = analyzeEmotion(text);
            updateEmotionFeedback(emotion);

            // ê¸¸ì´ ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸
            updateLengthIndicator(length);

            // AI í”„ë¡œë¸Œ íŠ¸ë¦¬ê±°
            if (length >= 30 && length <= 100 && !state.aiProbeActive) {
                triggerAIProbe(emotion);
            } else if (length > 200 && state.aiProbeActive) {
                hideAIProbe();
            }

            // ì‹¤ì‹œê°„ AI ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
            updateAIMessage(emotion, length);
        }

        // ê°ì • ë¶„ì„ (ì‹œë®¬ë ˆì´ì…˜)
        function analyzeEmotion(text) {
            const lowerText = text.toLowerCase();
            
            // ê°„ë‹¨í•œ í‚¤ì›Œë“œ ê¸°ë°˜ ê°ì • ë¶„ì„
            if (lowerText.includes('ê¸°ì˜') || lowerText.includes('í–‰ë³µ') || lowerText.includes('ì¢‹') || lowerText.includes('ì›ƒ')) {
                return 'happy';
            } else if (lowerText.includes('ìŠ¬í”„') || lowerText.includes('ìš°ìš¸') || lowerText.includes('í˜ë“¤') || lowerText.includes('ëˆˆë¬¼')) {
                return 'sad';
            } else if (lowerText.includes('í™”') || lowerText.includes('ì§œì¦') || lowerText.includes('ë¶„ë…¸') || lowerText.includes('ìš•')) {
                return 'angry';
            } else if (lowerText.includes('í‰ì˜¨') || lowerText.includes('í¸ì•ˆ') || lowerText.includes('ì°¨ë¶„') || lowerText.includes('ì¡°ìš©')) {
                return 'calm';
            } else if (lowerText.includes('í¥ë¯¸') || lowerText.includes('ê¸°ëŒ€') || lowerText.includes('ì„¤ë ˜') || lowerText.includes('ì‹ ë‚˜')) {
                return 'excited';
            } else {
                return 'neutral';
            }
        }

        // ê°ì • í”¼ë“œë°± ì—…ë°ì´íŠ¸
        function updateEmotionFeedback(emotion) {
            if (emotion === state.currentEmotion) return;
            
            state.currentEmotion = emotion;
            
            // ì˜¤ë¼ ì—…ë°ì´íŠ¸
            const emotionAura = document.getElementById('emotionAura');
            emotionAura.className = `emotion-aura ${emotion}`;
            emotionAura.style.opacity = '1';
            
            // ì´ëª¨ì§€ ì—…ë°ì´íŠ¸
            document.getElementById('emotionEmoji').textContent = emotionEmojis[emotion];
            
            // ìº í”„íŒŒì´ì–´ ë¶ˆê½ƒ ì—…ë°ì´íŠ¸
            const campfireFire = document.getElementById('campfireFire');
            campfireFire.className = `fire ${emotion}`;
        }

        // ê¸¸ì´ ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸
        function updateLengthIndicator(length) {
            const indicator = document.getElementById('emotionIndicator');
            const lengthNumber = document.getElementById('lengthNumber');
            
            const percentage = Math.min((length / 500) * 100, 100);
            lengthNumber.textContent = length;
            
            indicator.style.background = 
                `conic-gradient(#ff6b35 ${percentage * 3.6}deg, rgba(255, 255, 255, 0.1) ${percentage * 3.6}deg)`;

            // ë§ˆì¼ìŠ¤í†¤ íš¨ê³¼
            if (length === 100 || length === 200 || length === 300 || length === 500) {
                indicator.style.animation = 'milestoneGlow 1s ease';
                setTimeout(() => {
                    indicator.style.animation = 'none';
                }, 1000);
                showToast(`ğŸ‰ ${length}ì ë‹¬ì„±! ë¶ˆê½ƒì´ ë” í™œí™œ íƒ€ì˜¤ë¦…ë‹ˆë‹¤!`);
            }
        }

        // AI ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
        function updateAIMessage(emotion, length) {
            const aiMessage = document.getElementById('aiMessage');
            
            if (length > 200) {
                aiMessage.textContent = "ì™€! ì •ë§ ê¹Šì´ ìˆëŠ” ì´ì•¼ê¸°ë„¤ìš”! ê³„ì† ë“¤ë ¤ì£¼ì„¸ìš”! âœ¨";
            } else if (length > 100) {
                aiMessage.textContent = "ì ì  ë” ë§ˆìŒì´ ì—´ë¦¬ëŠ” ê²ƒ ê°™ì•„ìš” ğŸ’–";
            } else {
                aiMessage.textContent = aiMessages[emotion];
            }
        }

        // AI í”„ë¡œë¸Œ íŠ¸ë¦¬ê±°
        function triggerAIProbe(emotion) {
            if (state.aiProbeActive) return;
            
            state.aiProbeActive = true;
            const probeSystem = document.getElementById('aiProbeSystem');
            const probeQuestion = document.getElementById('aiProbeQuestion');
            
            const questions = emotionProbes[emotion] || emotionProbes.neutral;
            const randomQuestion = questions[Math.floor(Math.random() * questions.length)];
            
            probeQuestion.textContent = randomQuestion;
            probeSystem.classList.add('show');
        }

        // AI í”„ë¡œë¸Œ ìˆ¨ê¸°ê¸°
        function hideAIProbe() {
            state.aiProbeActive = false;
            document.getElementById('aiProbeSystem').classList.remove('show');
        }

        // ì €ì¥ ê¸°ëŠ¥
        function saveEntry() {
            const mainText = document.getElementById('mainTextarea').value;
            const probeText = document.getElementById('aiProbeInput').value;
            
            if (mainText.length < 20) {
                showToast("âš ï¸ Lunaê°€ ë” ë§ì€ ì´ì•¼ê¸°ë¥¼ ë“£ê³  ì‹¶ì–´í•´ìš”! (ìµœì†Œ 20ì)");
                return;
            }

            // ìƒíƒœ ì—…ë°ì´íŠ¸
            state.entryCount++;
            state.totalChars += mainText.length + probeText.length;
            state.lastEntryDate = new Date().toDateString();
            
            // ì—°ì† ì¼ìˆ˜ ê³„ì‚°
            updateStreak();
            
            // ì¼ì¼ ëª©í‘œ ë‹¬ì„± ì²´í¬
            if (mainText.length >= 100) {
                state.dailyGoalMet = true;
                showToast("ğŸ¯ ì˜¤ëŠ˜ì˜ ëª©í‘œ ë‹¬ì„±! Lunaê°€ ì •ë§ ê¸°ë»í•´ìš”!");
            }

            // ê°ì • ê¸°ë°˜ ë³´ìƒ ë©”ì‹œì§€
            const emotion = state.currentEmotion;
            let rewardMessage = "";
            
            if (mainText.length >= 500) {
                rewardMessage = "ğŸ”¥ğŸ”¥ğŸ”¥ ë†€ë¼ìš´ ê¹Šì´ì˜ ê¸°ë¡ì´ì—ìš”! Lunaê°€ ê°ë™í–ˆì–´ìš”!";
                createFireworks();
            } else if (mainText.length >= 300) {
                rewardMessage = emotion === 'happy' ? 
                    "âœ¨ ê¸°ìœ ë§ˆìŒì´ ê¸€ì— ê°€ë“í•´ìš”! í–‰ë³µ ì „ì—¼ë˜ë„¤ìš”!" :
                    emotion === 'sad' ?
                    "ğŸ’™ ì•„í”ˆ ë§ˆìŒì„ ë‚˜ëˆ ì£¼ì…”ì„œ ê³ ë§ˆì›Œìš”. Lunaê°€ í•¨ê»˜ ìˆì–´ìš”" :
                    "ğŸŒŸ ì •ë§ ì§„ì†”í•œ ì´ì•¼ê¸°ë„¤ìš”. Lunaê°€ ê¹Šì´ ê³µê°í•´ìš”";
            } else if (mainText.length >= 200) {
                rewardMessage = "ğŸ’« Lunaê°€ ë‹¹ì‹ ì˜ ë§ˆìŒì„ ë” ì˜ ì´í•´í•˜ê²Œ ë˜ì—ˆì–´ìš”!";
            } else {
                rewardMessage = "ğŸŒ± ì†Œì¤‘í•œ ê¸°ë¡ì´ì—ìš”. ë‚´ì¼ë„ í•¨ê»˜í•´ìš”!";
            }

            showToast(rewardMessage);

            // ìº í”„íŒŒì´ì–´ í•´ê¸ˆ ì²´í¬
            if (state.entryCount >= 3 && !state.campfireUnlocked) {
                state.campfireUnlocked = true;
                showToast("ğŸ”¥ ì¶•í•˜í•´ìš”! ìº í”„íŒŒì´ì–´ê°€ í•´ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤!");
                document.getElementById('campfireBtn').disabled = false;
            }

            // ì´ˆê¸°í™”
            document.getElementById('mainTextarea').value = '';
            document.getElementById('aiProbeInput').value = '';
            hideAIProbe();
            resetIndicators();
            
            // ìƒíƒœ ì €ì¥ ë° UI ì—…ë°ì´íŠ¸
            saveState();
            updateUI();
            
            // Dock ìœ ë„ (3ë²ˆì§¸ ì €ì¥ í›„)
            if (state.entryCount === 3 && !state.dockAdded) {
                setTimeout(showDockPrompt, 1000);
            }

            // ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§
            scheduleNotifications();
        }

        // ì—°ì† ì¼ìˆ˜ ì—…ë°ì´íŠ¸
        function updateStreak() {
            const today = new Date().toDateString();
            const yesterday = new Date(Date.now() - 86400000).toDateString();
            
            if (state.lastEntryDate === yesterday) {
                state.streakDays++;
            } else if (state.lastEntryDate !== today) {
                state.streakDays = 1;
            }
        }

        // Dock í”„ë¡¬í”„íŠ¸ í‘œì‹œ
        function showDockPrompt() {
            document.getElementById('dockPromptOverlay').style.display = 'flex';
        }

        // Dock í”„ë¡¬í”„íŠ¸ ë‹«ê¸°
        function closeDockPrompt() {
            document.getElementById('dockPromptOverlay').style.display = 'none';
        }

        // Dock ì¶”ê°€
        function addToDock() {
            state.dockAdded = true;
            saveState();
            closeDockPrompt();
            showToast("ğŸ“± Dockì— ì¶”ê°€ë¨! ì´ì œ Lunaë¥¼ ë” ìì£¼ ë§Œë‚  ìˆ˜ ìˆì–´ìš”!");
            
            // ë³´ë„ˆìŠ¤ ì œê³µ
            setTimeout(() => {
                showToast("ğŸ Dock ë³´ë„ˆìŠ¤: ì˜¤ëŠ˜ ë¶ˆê½ƒì´ 2ë°°ë¡œ ë°ì•„ì§‘ë‹ˆë‹¤!");
            }, 2000);
        }

        // ì¼ì¼ ëª©í‘œ ì²´í¬
        function checkDailyGoal() {
            const today = new Date().toDateString();
            if (state.lastEntryDate !== today) {
                state.dailyGoalMet = false;
            }

            // ëª©í‘œ ë‹¬ì„±í•˜ì§€ ì•Šì€ ê²½ìš° ì•Œë¦¼
            if (!state.dailyGoalMet) {
                document.getElementById('homeNotification').style.display = 'block';
            }
        }

        // ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§
        function scheduleNotifications() {
            if (!state.notificationPermission) {
                // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ (ì‹œë®¬ë ˆì´ì…˜)
                setTimeout(() => {
                    showToast("ğŸ”” Lunaê°€ ë§¤ì¼ ì°¾ì•„ê°ˆ ìˆ˜ ìˆê²Œ ì•Œë¦¼ì„ í—ˆìš©í•´ì£¼ì„¸ìš”!");
                }, 3000);
                state.notificationPermission = true;
            }

            // ë§¤ì¼ ì €ë… 9ì‹œ ì•Œë¦¼ (ì‹œë®¬ë ˆì´ì…˜)
            const now = new Date();
            const tonight = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 21, 0, 0);
            
            if (tonight > now && !state.dailyGoalMet) {
                setTimeout(() => {
                    showToast("ğŸŒ… Luna: ì˜¤ëŠ˜ í•˜ë£¨ëŠ” ì–´ë• ë‚˜ìš”? í•¨ê»˜ ê¸°ë¡í•´ë´ìš”!");
                }, 5000); // ë°ëª¨ìš© 5ì´ˆ í›„
            }
        }

        // í­ì£½ íš¨ê³¼
        function createFireworks() {
            for (let i = 0; i < 12; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.style.cssText = `
                        position: fixed;
                        width: 8px;
                        height: 8px;
                        background: ${['#ff6b35', '#ffd700', '#ff69b4', '#00ff00'][Math.floor(Math.random() * 4)]};
                        border-radius: 50%;
                        top: 50%;
                        left: 50%;
                        animation: fireworkExplode 2s ease-out forwards;
                        pointer-events: none;
                        z-index: 1500;
                    `;
                    
                    const angle = (360 / 12) * i;
                    firework.style.setProperty('--angle', angle + 'deg');
                    
                    document.body.appendChild(firework);
                    
                    setTimeout(() => {
                        if (firework.parentNode) {
                            firework.parentNode.removeChild(firework);
                        }
                    }, 2000);
                }, i * 100);
            }
        }

        // ì¸ë””ì¼€ì´í„° ë¦¬ì…‹
        function resetIndicators() {
            const indicator = document.getElementById('emotionIndicator');
            const lengthNumber = document.getElementById('lengthNumber');
            const emotionAura = document.getElementById('emotionAura');
            
            lengthNumber.textContent = '0';
            indicator.style.background = 'conic-gradient(#ff6b35 0deg, rgba(255, 255, 255, 0.1) 0deg)';
            emotionAura.style.opacity = '0';
            emotionAura.className = 'emotion-aura';
            
            document.getElementById('emotionEmoji').textContent = 'ğŸŒ±';
            state.currentLength = 0;
            state.currentEmotion = 'neutral';
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            document.getElementById('streakCounter').textContent = `${state.streakDays}ì¼ ì—°ì†`;
            document.getElementById('streakBadge').textContent = `ğŸ”¥ ${state.streakDays}ì¼ì°¨`;
            document.getElementById('totalDays').textContent = `${state.streakDays}ì¼`;
            document.getElementById('totalChars').textContent = `${state.totalChars}ì`;
            
            if (state.entryCount >= 3) {
                document.getElementById('campfireStatus').textContent = 'í•´ê¸ˆë¨! ğŸ”¥';
                document.getElementById('campfireBtn').disabled = false;
            } else {
                document.getElementById('campfireStatus').textContent = `${3 - state.entryCount}íšŒ ë” í•„ìš”`;
            }

            // ì•Œë¦¼ ì  ì—…ë°ì´íŠ¸
            if (!state.dailyGoalMet) {
                document.getElementById('homeNotification').style.display = 'block';
            } else {
                document.getElementById('homeNotification').style.display = 'none';
            }
        }

        // ë·° ì „í™˜
        function switchView(view) {
            const views = document.querySelectorAll('.main-view');
            const navBtns = document.querySelectorAll('.nav-btn');
            
            views.forEach(v => v.classList.remove('active'));
            navBtns.forEach(btn => btn.classList.remove('active'));
            
            if (view === 'home') {
                document.getElementById('homeView').classList.add('active');
                document.getElementById('homeNavBtn').classList.add('active');
            } else if (view === 'campfire') {
                document.getElementById('campfireView').classList.add('active');
                document.getElementById('campfireNavBtn').classList.add('active');
            }
        }

        // ìº í”„íŒŒì´ì–´ ì ‘ê·¼
        function tryAccessCampfire() {
            if (state.entryCount >= 3) {
                switchView('campfire');
            } else {
                showToast(`ğŸ”’ Luna: ìº í”„íŒŒì´ì–´ê¹Œì§€ ${3 - state.entryCount}íšŒ ë” ê¸°ë¡ì´ í•„ìš”í•´ìš”!`);
            }
        }

        // ìº í”„íŒŒì´ì–´ ì €ì¥
        function saveCampfireEntry() {
            const text = document.getElementById('campfireTextarea').value;
            
            if (text.length < 50) {
                showToast("ğŸ”¥ ìº í”„íŒŒì´ì–´ì—ëŠ” ë” ê¹Šì€ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”! (ìµœì†Œ 50ì)");
                return;
            }

            showToast("ğŸ”¥ ë”°ëœ»í•œ ì´ì•¼ê¸°ê°€ ìº í”„íŒŒì´ì–´ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!");
            document.getElementById('campfireTextarea').value = '';
        }

        // ì´ëª¨ì§€ ì¶”ê°€
        function addEmoji() {
            const emojis = ['ğŸ˜Š', 'ğŸ˜Œ', 'ğŸ¤”', 'ğŸ˜¢', 'ğŸ˜¡', 'ğŸ˜±', 'ğŸ˜´', 'ğŸ¥°', 'ğŸ‰', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«'];
            const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
            
            const textarea = document.getElementById('campfireTextarea');
            const cursorPos = textarea.selectionStart;
            const textBefore = textarea.value.substring(0, cursorPos);
            const textAfter = textarea.value.substring(cursorPos);
            
            textarea.value = textBefore + randomEmoji + ' ' + textAfter;
            textarea.setSelectionRange(cursorPos + 2, cursorPos + 2);
            textarea.focus();
        }

        // ìƒíƒœ ì €ì¥/ë¡œë“œ
        function saveState() {
            localStorage.setItem('sunset_ai_state', JSON.stringify(state));
        }

        function loadState() {
            const saved = localStorage.getItem('sunset_ai_state');
            if (saved) {
                state = { ...state, ...JSON.parse(saved) };
            }
        }

        // ê¸°íƒ€ ê¸°ëŠ¥ë“¤
        function showStats() {
            const avgLength = state.entryCount > 0 ? Math.round(state.totalChars / state.entryCount) : 0;
            showToast(`ğŸ“Š í‰ê·  ${avgLength}ìì”© ${state.entryCount}íšŒ ê¸°ë¡. Luna ë§Œì¡±ë„: ${Math.min(100, state.streakDays * 10)}%`);
        }

        function showSettings() {
            showToast("âš™ï¸ Luna ì„¤ì •: ì•Œë¦¼ ON, ê°ì • ë¶„ì„ ON, Dock ì—°ë™ " + (state.dockAdded ? "ON" : "OFF"));
        }

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'toastSlide 0.3s ease-out reverse';
                setTimeout(() => {
                    if (toast.parentNode) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 4000);
        }

        // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
        const style = document.createElement('style');
        style.textContent = `
            @keyframes milestoneGlow {
                0% { transform: scale(1); box-shadow: 0 0 0 rgba(255,107,53,0.7); }
                50% { transform: scale(1.2); box-shadow: 0 0 30px rgba(255,107,53,0.7); }
                100% { transform: scale(1); box-shadow: 0 0 0 rgba(255,107,53,0.7); }
            }
            
            @keyframes fireworkExplode {
                0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                100% { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0) 
                               translateX(calc(cos(var(--angle)) * 150px))
                               translateY(calc(sin(var(--angle)) * 150px));
                }
            }
        `;
        document.head.appendChild(style);

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                saveEntry();
            }
        });
    </script>
</body>
</html>
